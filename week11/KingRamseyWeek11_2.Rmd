---
title: "EXERCISE 11.2"
author: "Ramsey King"
date: '2021-05-29'
output:
  html_document: default
  pdf_document: default
  word_document: default
# bibliography: bibliography.bib
---

```{r setup, echo=FALSE}
#knitr::opts_knit$set(root.dir = 'C:/Users/Ramsey/Documents/GitHub/dsc520/')
knitr::opts_knit$set(root.dir = '/home/ramsey/GitHub/dsc520')
```

## In this problem, you will use the nearest neighbors algorithm to fit a model on two simplified datasets. 

## The first dataset (found in binary-classifier-data.csv) contains three variables; label, x, and y. The label variable is either 0 or 1 and is the output we want to predict using the x and y variables (You worked with this dataset last week!). 

## The second dataset (found in trinary-classifier-data.csv) is similar to the first dataset except that the label variable can be 0, 1, or 2.

### 1. Plot the data from each dataset using a scatter plot.

```{r scatter_plot_binary, echo=FALSE}
## Read the csv file in the binary_classifier variable
binary_data <- read.csv("assignments/week11/binary-classifier-data.csv")

## load the ggplot2 library
library(ggplot2)

## Scatter plot of the binary data set.
ggplot(binary_data, aes(x = x, y = y)) +
  geom_point()
```
```{r scatter_plot_trinary, echo=FALSE}
## Read the csv file in the binary_classifier variable
trinary_data <- read.csv("assignments/week11/trinary-classifier-data.csv")

## load the ggplot2 library
library(ggplot2)

## Scatter plot of the tridary data set.
ggplot(trinary_data, aes(x = x, y = y)) +
  geom_point()
```


### 2. Fit a k nearest neighborsâ€™ model for each dataset for k=3, k=5, k=10, k=15, k=20, and k=25. Compute the accuracy of the resulting models for each value of k. Plot the results in a graph where the x-axis is the different values of k and the y-axis is the accuracy of the model.

```{r k_means_binary, echo=FALSE}
library(caret)
set.seed(36912)
binarytrainIndex <- createDataPartition(binary_data$label, p = 0.7,
                                        list = F,
                                        times = 1)
binary_train_dataset <- binary_data[binarytrainIndex,]
binary_test_dataset <- binary_data[-binarytrainIndex,]

#binary_target_category <- binary_train_dataset$label
#binary_test_category <- binary_test_dataset$label

binary_target_category <- binary_data[binarytrainIndex,1]
binary_test_category <- binary_data[-binarytrainIndex,1]


library(class)

knn3 <- knn(binary_train_dataset, binary_test_dataset, cl=binary_target_category,k=3)
tableknn3 <- table(knn3, binary_test_category)
tableknn3
acc3 <- sum(diag(tableknn3)/(sum(rowSums(tableknn3))))*100
acc3

knn5 <- knn(binary_train_dataset, binary_test_dataset, cl=binary_target_category,k=5)
tableknn5 <- table(knn5, binary_test_category)
tableknn5

knn10 <- knn(binary_train_dataset, binary_test_dataset, cl=binary_target_category,k=10)
tableknn10 <- table(knn10, binary_test_category)
tableknn10

knn15 <- knn(binary_train_dataset, binary_test_dataset, cl=binary_target_category,k=15)
tableknn15 <- table(knn15, binary_test_category)
tableknn15

knn20 <- knn(binary_train_dataset, binary_test_dataset, cl=binary_target_category,k=20)
tableknn20 <- table(knn20, binary_test_category)
tableknn20

knn25 <- knn(binary_train_dataset, binary_test_dataset, cl=binary_target_category,k=25)
tableknn25 <- table(knn25, binary_test_category)
tableknn25

#NEED TO COMUTE ACCURACY OF EACH KNN AND CREATE TABLE SO IT CAN BE PLOTTED.  THIS SEEMS OFF BECAUSE OF THE HIGH ACCURACY OF EACH MODEL
# BUT I NEED TO MOVE ON.

```